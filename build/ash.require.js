/**
 * almond 0.2.3 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 0.7.4 - Build: 252 (2012/02/24 10:30 PM)
 */

var requirejs,require,define;(function(e){function c(e,t){return f.call(e,t)}function h(e,t){var n,r,i,s,o,a,f,l,c,h,p=t&&t.split("/"),d=u.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))break;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=l;break}}}if(s)break;!a&&v&&v[r]&&(a=v[r],f=l)}!s&&a&&(s=a,o=f),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function p(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function d(e){return function(t){return h(t,e)}}function v(e){return function(t){s[e]=t}}function m(n){if(c(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!c(s,n)&&!c(a,n))throw new Error("No "+n);return s[n]}function g(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function y(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice;r=function(e,t){var n,r=g(e),i=r[0];return e=r[1],i&&(i=h(i,t),n=m(i)),i?n&&n.normalize?e=n.normalize(e,d(t)):e=h(e,t):(e=h(e,t),r=g(e),i=r[0],e=r[1],i&&(n=m(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return p(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:y(e)}}},t=function(t,n,u,f){var l,h,d,g,y,b=[],w;f=f||t;if(typeof u=="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){g=r(n[y],f),h=g.f;if(h==="require")b[y]=i.require(t);else if(h==="exports")b[y]=i.exports(t),w=!0;else if(h==="module")l=b[y]=i.module(t);else if(c(s,h)||c(o,h)||c(a,h))b[y]=m(h);else{if(!g.p)throw new Error(t+" missing "+h);g.p.load(g.n,p(f,!0),v(h),{}),b[y]=s[h]}}d=u.apply(s[t],b);if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(d!==e||!w)s[t]=d}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){return typeof s=="string"?i[s]?i[s](o):m(r(s,o).f):(s.splice||(u=s,o.splice?(s=o,o=a,a=null):s=e),o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},15),n)},n.config=function(e){return u=e,n},define=function(e,t,n){t.splice||(n=t,t=[]),!c(s,e)&&!c(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("almond",function(){}),function(e){function n(e,t,n,r,i){this._listener=t,this._isOnce=n,this.context=r,this._signal=e,this._priority=i||0}function r(e,t){if(typeof e!="function")throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}var t={VERSION:"0.7.4"};n.prototype={active:!0,params:null,execute:function(e){var t,n;return this.active&&!!this._listener&&(n=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},t.Signal=function(){this._bindings=[],this._prevParams=null},t.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,t,r,i){var s=this._indexOfListener(e,r),o;if(s!==-1){o=this._bindings[s];if(o.isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else o=new n(this,e,t,r,i),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(e){var t=this._bindings.length;do--t;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){var n=this._bindings.length,r;while(n--){r=this._bindings[n];if(r._listener===e&&r.context===t)return n}return-1},has:function(e,t){return this._indexOfListener(e,t)!==-1},add:function(e,t,n){return r(e,"add"),this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){return r(e,"addOnce"),this._registerListener(e,!0,t,n)},remove:function(e,t){r(e,"remove");var n=this._indexOfListener(e,t);return n!==-1&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),e},removeAll:function(){var e=this._bindings.length;while(e--)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(!this.active)return;var t=Array.prototype.slice.call(arguments),n=this._bindings.length,r;this.memorize&&(this._prevParams=t);if(!n)return;r=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(r[n]&&this._shouldPropagate&&r[n].execute(t)!==!1)},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},typeof define=="function"&&define.amd?define("libs/signals",t):typeof module!="undefined"&&module.exports?module.exports=t:e.signals=t}(this),function(e){function t(){typeof Object.create!="function"&&(Object.create=function(e){function t(){}return t.prototype=e,new t})}function n(){typeof Object.extend!="function"&&(Object.extend=function(e,t){for(var n in t)!e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(e[n]=t[n]);return e})}function r(){typeof Object.deepExtend!="function"&&(Object.deepExtend=function(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},arguments.callee(e[n],t[n])):e[n]=t[n];return e})}function i(){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){return e.setTimeout(t,1e3/60)};e.requestAnimationFrame=t;var n=e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||e.clearTimeout;e.cancelRequestAnimationFrame=n}function s(){e.Keyboard={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,CAPSLOCK:20,ESCAPE:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,NUMLOCK:144,SCROLL_LOCK:145,PAUSE_BREAK:19,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:13,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111}}function o(){function e(e,t){var n=t.length;for(var r=0;r<e.length;++r)for(var i=0;i<t.length;++i)e[r]==t[i]&&n--;return n===0}window.hasItems=e}e.TEST_ENV=0,e.STAGE_ENV=1,e.LIVE_ENV=2;var u={VERSION:"0.1.0",initialise:function(e){t(),n(),r(),i(),s(),e==TEST_ENV&&o()}};typeof define=="function"&&define.amd?define("brejep/fillsnfixes",u):typeof module!="undefined"&&module.exports?module.exports=u:e.fillsnfixes=u}(this),define("brejep/fillsnfixes",function(){}),function(e,t){typeof define=="function"&&define.amd?define("brejep/dictionary",t):(typeof e.brejep=="undefined"&&(e.brejep={}),e.brejep.dictionary=t())}(this,function(){function e(){this.initialise()}var t=e.prototype;return t.VERSION="0.1.0",t.keys=null,t.values=null,t.initialise=function(){return this.keys=[],this.values=[],this},t.add=function(e,t){var n=this.getIndex(e);n>=0?this.values[n]=t:(this.keys.push(e),this.values.push(t))},t.remove=function(e){var t=this.getIndex(e);if(!(t>=0))throw"Key does not exist";this.keys.splice(t,1),this.values.splice(t,1)},t.retrieve=function(e){var t=null,n=this.getIndex(e);return n>=0&&(t=this.values[n]),t},t.getIndex=function(e){var t=0,n=this.keys.length,r;for(;t<n;++t){r=this.keys[t];if(r==e)return t}return-1},t.has=function(e){var t=0,n=this.keys.length,r;for(;t<n;++t){r=this.keys[t];if(r==e)return!0}return!1},t.forEach=function(e){var t=0,n=this.keys.length,r,i;for(;t<n;++t){r=this.keys[t],i=this.values[t];var s=e(r,i);if(s=="return")return!1}return!0},e}),define("brejep/dictionary",function(){}),function(e,t){typeof define=="function"&&define.amd?define("brejep/point",t):(typeof e.brejep=="undefined"&&(e.brejep={}),e.brejep.point=t())}(this,function(){function e(e,t){this.x=e||0,this.y=t||0}return e.VERSION="0.1.0",e.prototype.x=null,e.prototype.y=null,e.prototype.distanceSquaredTo=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},e.prototype.distanceTo=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e}),define("brejep/point",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/entity",["libs/signals","brejep/dictionary"],t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.entity=t(e.signals,e.brejep.dictionary))}(this,function(e,t){function n(){this.initialise()}var r=n.prototype;return r.componentAdded=new e.Signal,r.componentRemoved=new e.Signal,r.previous=null,r.next=null,r.components=null,r.initialise=function(){return this.components=new t,this},r.add=function(e,t){return t=t||e.constructor,t=t.prototype,this.components.has(t)&&this.remove(t),this.components.add(t,e),this.componentAdded.dispatch(this,t),this},r.remove=function(e){e=e.prototype;var t=this.components.retrieve(e);return t?(this.components.remove(e),this.componentRemoved.dispatch(this,e),t):null},r.get=function(e){return this.components.retrieve(e.prototype)},r.getAll=function(){var e=[];return this.components.forEach(function(t,n){e.push(n)}),e},r.has=function(e){return this.components.has(e.prototype)},r.clone=function(){var e=new n;return this.components.forEach(function(t,n){var r=new t.constructor;for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);e.add(r)}),e},n}),function(e,t){typeof define=="function"&&define.amd?define("ash/entitylist",t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.entitylist=t())}(this,function(){function e(){}var t=e.prototype;return t.head=null,t.tail=null,t.add=function(e){this.head?(this.tail.next=e,e.previous=this.tail,this.tail=e):this.head=this.tail=e},t.remove=function(e){this.head==e&&(this.head=this.head.next),this.tail==e&&(this.tail=this.tail.previous),e.previous&&(e.previous.next=e.next),e.next&&(e.next.previous=e.previous)},t.removeAll=function(){while(this.head){var e=this.head;this.head=this.head.next,e.previous=null,e.next=null}this.tail=null},e}),define("ash/entitylist",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/node",t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.node=t())}(this,function(){function e(){}var t=e.prototype;return t.entity=null,t.previous=null,t.next=null,e}),define("ash/node",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/nodelist",["libs/signals"],t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.nodelist=t(e.signals))}(this,function(e){function t(){}return t.prototype.head=null,t.prototype.tail=null,t.prototype.nodeAdded=new e.Signal,t.prototype.nodeRemoved=new e.Signal,t.prototype.add=function(e){this.head?(this.tail.next=e,e.previous=this.tail,this.tail=e):this.head=this.tail=e,this.nodeAdded.dispatch(e)},t.prototype.remove=function(e){this.head==e&&(this.head=this.head.next),this.tail==e&&(this.tail=this.tail.previous),e.previous&&(e.previous.next=e.next),e.next&&(e.next.previous=e.previous),this.nodeRemoved.dispatch(e)},t.prototype.removeAll=function(){while(this.head){var e=this.head;this.head=e.next,e.previous=null,e.next=null,this.nodeRemoved.dispatch(e)}this.tail=null},t.prototype.empty=function(){return this.head==null},t.prototype.swap=function(e,t){if(e.previous==t)e.previous=t.previous,t.previous=e,t.next=e.next,e.next=t;else if(t.previous==e)t.previous=e.previous,e.previous=t,e.next=t.next,t.next=e;else{var n=e.previous;e.previous=t.previous,t.previous=n,n=e.next,e.next=t.next,t.next=n}this.head==e?this.head=t:this.head==t&&(this.head=e),this.tail==e?this.tail=t:this.tail==t&&(this.tail=e),e.previous&&(e.previous.next=e),t.previous&&(t.previous.next=t),e.next&&(e.next.previous=e),t.next&&(t.next.previous=t)},t.prototype.insertionSort=function(e){if(this.head==this.tail)return;var t=this.head.next;for(var n=t;n;n=t){t=n.next;for(var r=n.previous;r;r=r.previous)if(e(n,r)>=0){n!=r.next&&(this.tail==n&&(this.tail=n.previous),n.previous.next=n.next,n.next&&(n.next.previous=n.previous),n.next=r.next,n.previous=r,n.next.previous=n,r.next=n);break}r||(this.tail==n&&(this.tail=n.previous),n.previous.next=n.next,n.next&&(n.next.previous=n.previous),n.next=this.head,this.head.previous=n,n.previous=null,this.head=n)}},t.prototype.mergeSort=function(e){if(this.head==this.tail)return;var t=[],n=this.head,r;while(n){r=n;while(r.next&&e(r,r.next)<=0)r=r.next;var i=r.next;n.previous=r.next=null,t.push(n),n=i}while(t.length>1)t.push(this.merge(t.shift(),t.shift(),e));this.tail=this.head=t[0];while(this.tail.next)this.tail=this.tail.next},t.prototype.merge=function(e,t,n){var r,i;n(e,t)<=0?(i=r=e,e=e.next):(i=r=t,t=t.next);while(e&&t)n(e,t)<=0?(r.next=e,e.previous=r,r=e,e=e.next):(r.next=t,t.previous=r,r=t,t=t.next);return e?(r.next=e,e.previous=r):(r.next=t,t.previous=r),i},t}),function(e,t){typeof define=="function"&&define.amd?define("ash/nodepool",t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.nodepool=t())}(this,function(){function e(e){this.initialise(e)}var t=e.prototype;return t.tail=null,t.cacheTail=null,t.nodeClass=null,t.initialise=function(e){return this.nodeClass=e,this},t.get=function(){if(this.tail){var e=this.tail;return this.tail=this.tail.previous,e.previous=null,e}return new this.nodeClass},t.dispose=function(e){e.next=null,e.previous=this.tail,this.tail=e},t.cache=function(e){e.previous=this.cacheTail,this.cacheTail=e},t.releaseCache=function(){while(this.cacheTail){var e=this.cacheTail;this.cacheTail=e.previous,e.next=null,e.previous=this.tail,this.tail=e}},e}),define("ash/nodepool",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/family",[],t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.family=t())}(this,function(){function e(){}return e.prototype.nodes=null,e.prototype.__defineGetter__("nodeList",function(){return this.nodes}),e.prototype.initialise=function(e,t){throw new Error("should be overriden")},e.prototype.newEntity=function(e){throw new Error("should be overriden")},e.prototype.removeEntity=function(e){throw new Error("should be overriden")},e.prototype.componentAddedToEntity=function(e,t){throw new Error("should be overriden")},e.prototype.componentRemovedFromEntity=function(e,t){throw new Error("should be overriden")},e.prototype.cleanUp=function(){throw new Error("should be overriden")},e}),function(e,t){typeof define=="function"&&define.amd?define("ash/componentmatchingfamily",["ash/family","ash/nodepool","ash/nodelist","brejep/dictionary"],t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.componentmatchingfamily=t(e.ash.family,e.ash.nodepool,e.ash.nodelist,e.brejep.dictionary))}(this,function(e,t,n,r){function i(t,n){Object.extend(i.prototype,e.prototype),this.nodeClass=t,this.engine=n,this.initialise()}var s=i.prototype;return s.nodeClass=null,s.engine=null,s.nodes=null,s.entities=null,s.components=null,s.nodePool=null,s.__defineGetter__("nodeList",function(){return this.nodes}),s.initialise=function(){var e=this.nodeClass,i=this.nodePool=new t(e);this.nodes=new n,this.entities=new r,this.components=new r,i.dispose(i.get());var s=e.prototype;for(var o in s)if(s.hasOwnProperty(o)&&o!="types"&&o!="next"&&o!="previous"&&o!="entity"){var u=s.types[o];this.components.add(u,o)}return this},s.newEntity=function(e){this.addIfMatch(e)},s.componentAddedToEntity=function(e,t){this.addIfMatch(e)},s.componentRemovedFromEntity=function(e,t){this.components.has(t)&&this.removeIfMatch(e)},s.removeEntity=function(e){this.removeIfMatch(e)},s.cleanUp=function(){for(var e=this.nodes.head;e;e=e.next)delete this.entities.retrieve(e.entity);this.nodes.removeAll()},s.addIfMatch=function(e){if(!this.entities.has(e)){var t;if(!this.components.forEach(function(t,n){if(!e.has(t))return"return"}))return;var n=this.nodePool.get();n.entity=e,this.components.forEach(function(t,r){n[r]=e.get(t)}),this.entities.add(e,n),e.componentRemoved.add(this.componentRemovedFromEntity,this),this.nodes.add(n)}},s.removeIfMatch=function(e){var t=this.entities,n=this.nodes,r=this.engine,i=this.nodePool;if(t.has(e)){var s=t.retrieve(e);e.componentRemoved.remove(this.componentRemovedFromEntity,this),t.remove(e),n.remove(s),r.updating?(i.cache(s),r.updateComplete.add(this.releaseNodePoolCache,this)):i.dispose(s)}},s.releaseNodePoolCache=function(){this.engine.updateComplete.remove(this.releaseNodePoolCache),this.nodePool.releaseCache()},i}),function(e,t){typeof define=="function"&&define.amd?define("ash/system",t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.system=t())}(this,function(){function e(){}return e.prototype.previous=null,e.prototype.next=null,e.prototype.priority=0,e.prototype.initialise=function(){return this},e.prototype.addToEngine=function(e){},e.prototype.removeFromEngine=function(e){},e.prototype.update=function(e){},e.prototype.is=function(e){return e.prototype.isPrototypeOf(this)},e}),define("ash/system",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/systemlist",t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.systemlist=t())}(this,function(){function e(){}var t=e.prototype;return t.head=null,t.tail=null,t.add=function(e){if(!this.head)this.head=this.tail=e,e.next=e.previous=null;else{for(var t=this.tail;t;t=t.previous)if(t.priority<=e.priority)break;t==this.tail?(this.tail.next=e,e.previous=this.tail,e.next=null,this.tail=e):t?(e.next=t.next,e.previous=t,t.next.previous=e,t.next=e):(e.next=this.head,e.previous=null,this.head.previous=e,this.head=e)}},t.remove=function(e){this.head==e&&(this.head=this.head.next),this.tail==e&&(this.tail=this.tail.previous),e.previous&&(e.previous.next=e.next),e.next&&(e.next.previous=e.previous)},t.removeAll=function(){while(this.head){var e=this.head;this.head=this.head.next,e.previous=null,e.next=null}this.tail=null},t.get=function(e){for(var t=this.head;t;t=t.next)if(t.is(e))return t;return null},e}),define("ash/systemlist",function(){}),function(e,t){typeof define=="function"&&define.amd?define("ash/engine",["ash/componentmatchingfamily","ash/entitylist","ash/systemlist","libs/signals","brejep/dictionary"],t):(typeof e.ash=="undefined"&&(e.ash={}),e.ash.engine=t(e.ash.componentmatchingfamily,e.ash.entitylist,e.ash.systemlist,e.signals,e.brejep.dictionary))}(this,function(e,t,n,r,i){function s(){this.initialise()}var o=s.prototype;return o.initialise=function(){return this.entityList=new t,this.systemList=new n,this.families=new i,this.__defineGetter__("entities",function(){var e=[];for(var t=this.entityList.head;t;t=t.next)e.push(t);return e}),this.__defineGetter__("systems",function(){var e=[];for(var t=this.systemList.head;t;t=t.next)e.push(t);return e}),this},o.familyClass=e,o.families=null,o.entityList=null,o.systemList=null,o.updating=!1,o.updateComplete=new r.Signal,o.addEntity=function(e){this.entityList.add(e),e.componentAdded.add(this.componentAdded,this),this.families.forEach(function(t,n){n.newEntity(e)})},o.removeEntity=function(e){e.componentAdded.remove(this.componentAdded,this),this.families.forEach(function(t,n){n.removeEntity(e)}),this.entityList.remove(e)},o.removeAllEntities=function(){while(this.entityList.head)this.removeEntity(this.entityList.head)},o.componentAdded=function(e,t){this.families.forEach(function(n,r){r.componentAddedToEntity(e,t)})},o.getNodeList=function(e){if(this.families.has(e))return this.families.retrieve(e).nodes;var t=new this.familyClass(e,this);this.families.add(e,t);for(var n=this.entityList.head;n;n=n.next)t.newEntity(n);return t.nodes},o.releaseNodeList=function(e){this.families.has(e)&&this.families.retrieve(e).cleanUp(),this.families.remove(e)},o.addSystem=function(e,t){e.priority=t,e.addToEngine(this),this.systemList.add(e)},o.getSystem=function(e){return this.systemList.get(e)},o.removeSystem=function(e){this.systemList.remove(e),e.removeFromEngine(this)},o.removeAllSystems=function(){while(this.systemList.head)this.removeSystem(this.systemList.head)},o.update=function(e){this.updating=!0;for(var t=this.systemList.head;t;t=t.next)t.update(e);this.updating=!1,this.updateComplete.dispatch()},s}),require(["require"],function(e){e(["almond","libs/signals","brejep/fillsnfixes","brejep/dictionary","brejep/point","ash/entity","ash/entitylist","ash/node","ash/nodelist","ash/nodepool","ash/family","ash/componentmatchingfamily","ash/system","ash/systemlist","ash/engine"])}),define("build/ash-build",function(){});